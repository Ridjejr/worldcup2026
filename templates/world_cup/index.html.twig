{% extends 'base.html.twig' %}

{% block title %}Coupe du Monde 2026 - Accueil{% endblock %}

{% block stylesheets %}
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Bebas+Neue&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: #0f1419; color: #ffffff; }

        .header { background: linear-gradient(180deg, #1a1f2e 0%, #141923 100%); border-bottom: 1px solid #2a3441; position: sticky; top: 0; z-index: 100; }
        .header-container { max-width: 1440px; margin: 0 auto; padding: 0 48px; display: flex; justify-content: space-between; align-items: center; height: 80px; }
        .logo { display: flex; align-items: center; gap: 12px; }
        .logo-text { font-family: 'Bebas Neue', cursive; font-size: 28px; letter-spacing: 1.5px; background: linear-gradient(135deg, #00ff87 0%, #60efff 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        .nav { display: flex; gap: 40px; }
        .nav-item { color: #8899a6; text-decoration: none; font-weight: 600; font-size: 15px; transition: color 0.3s; position: relative; }
        .nav-item:hover { color: #ffffff; }
        .nav-item.active { color: #00ff87; }
        .nav-item.active::after { content: ''; position: absolute; bottom: -28px; left: 0; right: 0; height: 3px; background: #00ff87; }

        .container { max-width: 1440px; margin: 0 auto; padding: 32px 48px; }
        .layout { display: grid; grid-template-columns: 1fr 380px; gap: 32px; }

        .page-header { margin-bottom: 40px; }
        .page-title { font-family: 'Bebas Neue', cursive; font-size: 48px; letter-spacing: 2px; margin-bottom: 8px; }
        .page-subtitle { color: #8899a6; font-size: 16px; }

        .tabs { display: flex; gap: 8px; margin-bottom: 32px; border-bottom: 1px solid #2a3441; padding-bottom: 16px; flex-wrap: wrap; }
        .tab { padding: 12px 24px; border-radius: 8px; background: transparent; border: none; color: #8899a6; font-weight: 600; font-size: 15px; cursor: pointer; transition: all 0.3s; text-decoration: none; }
        .tab:hover { background: #1a1f2e; color: #ffffff; }
        .tab.active { background: #00ff87; color: #0f1419; }

        .matches-grid { display: grid; gap: 20px; }

        .match-card {
            background: linear-gradient(135deg, #1a1f2e 0%, #141923 100%);
            border-radius: 16px;
            padding: 24px;
            border: 1px solid #2a3441;
            transition: all 0.3s;
            cursor: pointer;
            display: block;
            text-decoration: none;
            color: inherit;
        }
        .match-card:hover { border-color: #00ff87; transform: translateY(-4px); box-shadow: 0 8px 32px rgba(0, 255, 135, 0.1); }

        .match-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .match-info { display: flex; gap: 16px; align-items: center; }
        .match-phase { background: #2a3441; color: #8899a6; padding: 6px 12px; border-radius: 6px; font-size: 12px; font-weight: 700; text-transform: uppercase; }
        .match-time { color: #8899a6; font-size: 14px; font-weight: 600; }

        .match-status { padding: 6px 16px; border-radius: 20px; font-size: 11px; font-weight: 800; text-transform: uppercase; letter-spacing: 0.5px; }
        .status-live { background: linear-gradient(135deg, #00ff87 0%, #00d980 100%); color: #0f1419; animation: pulse 2s infinite; }
        .status-finished { background: #2a3441; color: #60efff; }
        .status-scheduled { background: #2a3441; color: #8899a6; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }

        .teams-container { display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; gap: 24px; margin-bottom: 20px; }
        .team { display: flex; align-items: center; gap: 16px; }
        .team.away { flex-direction: row-reverse; text-align: right; }
        .team-flag { font-size: 48px; line-height: 1; }
        .team-name { font-size: 20px; font-weight: 700; color: #ffffff; margin-bottom: 4px; }
        .team-code { font-size: 13px; color: #8899a6; font-weight: 600; }

        .score-container { display: flex; align-items: center; justify-content: center; gap: 16px; min-width: 120px; }
        .score { font-family: 'Bebas Neue', cursive; font-size: 48px; color: #00ff87; line-height: 1; }
        .score-separator { font-size: 32px; color: #2a3441; font-weight: 700; }
        .vs { font-family: 'Bebas Neue', cursive; font-size: 28px; color: #2a3441; letter-spacing: 2px; }

        .match-stats { display: flex; gap: 24px; padding-top: 16px; border-top: 1px solid #2a3441; flex-wrap: wrap; }
        .stat-item { display: flex; align-items: center; gap: 8px; color: #8899a6; font-size: 13px; }
        .stat-icon { font-size: 16px; }

        .sidebar { position: sticky; top: 112px; height: fit-content; }
        .sidebar-title { font-family: 'Bebas Neue', cursive; font-size: 20px; letter-spacing: 1.5px; color: #00ff87; margin-bottom: 16px; }

        .upcoming-match { background: linear-gradient(135deg, #1a1f2e 0%, #141923 100%); border-radius: 12px; padding: 16px; border: 1px solid #2a3441; margin-bottom: 12px; transition: all 0.3s; }
        .upcoming-match:hover { border-color: #00ff87; }
        .upcoming-match-time { font-size: 12px; color: #8899a6; font-weight: 600; margin-bottom: 8px; }
        .upcoming-teams { display: flex; align-items: center; justify-content: space-between; gap: 8px; }
        .upcoming-team { display: flex; align-items: center; gap: 6px; font-size: 13px; font-weight: 600; }
        .upcoming-flag { font-size: 18px; }

        .date-separator { display: flex; align-items: center; gap: 16px; margin: 32px 0 24px 0; }
        .date-separator-text { font-family: 'Bebas Neue', cursive; font-size: 24px; color: #00ff87; letter-spacing: 1.5px; white-space: nowrap; }
        .date-separator-line { flex: 1; height: 2px; background: linear-gradient(to right, rgba(0, 255, 135, 0.5), transparent); }

        @media (max-width: 1200px) { .layout { grid-template-columns: 1fr; } .sidebar { position: static; } }
    </style>
{% endblock %}

{% block body %}
<div class="header">
    <div class="header-container">
        <div class="logo">
            <span style="font-size: 32px;">‚öΩ</span>
            <span class="logo-text">WORLD CUP 2026</span>
        </div>
        <nav class="nav">
            <a href="{{ path('app_home') }}" class="nav-item active">Accueil</a>
            <a href="/matches" class="nav-item">Matchs</a>
            <a href="{{ path('app_groupes') }}" class="nav-item">Groupes</a>
            <a href="/equipes" class="nav-item">√âquipes</a>
            <a href="/statistiques" class="nav-item">Statistiques</a>
        </nav>
    </div>
</div>

<div class="container">
    <div class="page-header">
        <h1 class="page-title">üèÜ COUPE DU MONDE 2026</h1>
        <p class="page-subtitle">
            üìÖ {{ edition.dateDebut|date('d F Y') }} - {{ edition.dateFin|date('d F Y') }}
            ‚Ä¢ üìç Canada ‚Ä¢ √âtats-Unis ‚Ä¢ Mexique
        </p>
    </div>

    {# TABS PHASES #}
    <div class="tabs">
        <a class="tab {{ selectedPhase is null ? 'active' : '' }}" href="{{ path('app_home') }}">Tous</a>
        {% for phase in phases %}
            <a class="tab {{ selectedPhase and selectedPhase.id == phase.id ? 'active' : '' }}"
               href="{{ path('app_home', { phase: phase.id }) }}">
                {{ phase.libelle }}
            </a>
        {% endfor %}
    </div>

    <div class="layout">
        <main class="main-content">
            <div class="matches-grid">
                {% set currentDate = null %}
                {% for data in matchesData %}
                    {% set match = data.match %}
                    {% set domicile = data.domicile %}
                    {% set exterieur = data.exterieur %}
                    {% set matchDate = match.dateHeure|date('Y-m-d') %}

                    {% if matchDate != currentDate %}
                        {% set currentDate = matchDate %}
                        <div class="date-separator">
                            <div class="date-separator-text">
                                üìÜ {{ match.dateHeure|date('l d F Y')|upper }}
                            </div>
                            <div class="date-separator-line"></div>
                        </div>
                    {% endif %}

                    {# Match card cliquable #}
                    <a class="match-card" href="{{ path('app_match_detail', { id: match.id }) }}">
                        <div class="match-header">
                            <div class="match-info">
                                <div class="match-phase">{{ match.phase.libelle }}</div>
                                <div class="match-time">{{ match.dateHeure|date('H:i') }}</div>
                            </div>
                            <div class="match-status
                                {% if match.statut == 'EN_COURS' %}status-live
                                {% elseif match.statut == 'TERMINE' %}status-finished
                                {% else %}status-scheduled{% endif %}">
                                {% if match.statut == 'EN_COURS' %}
                                    ‚óè LIVE
                                {% elseif match.statut == 'TERMINE' %}
                                    TERMIN√â
                                {% else %}
                                    √Ä VENIR
                                {% endif %}
                            </div>
                        </div>

                        <div class="teams-container">
                            <div class="team">
                                <div class="team-flag">
                                    {% if data.domicileDrapeau %}
                                        {{ data.domicileDrapeau }}
                                    {% else %}
                                        üè¥
                                    {% endif %}
                                </div>
                                <div class="team-details">
                                    <div class="team-name">{{ domicile.equipe.nomEquipe }}</div>
                                    <div class="team-code">{{ domicile.equipe.codePays }}</div>
                                </div>
                            </div>

                            <div class="score-container">
                                {% if match.statut == 'A_VENIR' %}
                                    <div class="vs">VS</div>
                                {% else %}
                                    <div class="score">{{ domicile.buts ?? 0 }}</div>
                                    <div class="score-separator">-</div>
                                    <div class="score">{{ exterieur.buts ?? 0 }}</div>
                                {% endif %}
                            </div>

                            <div class="team away">
                                <div class="team-flag">
                                    {% if data.exterieurDrapeau %}
                                        {{ data.exterieurDrapeau }}
                                    {% else %}
                                        üè¥
                                    {% endif %}
                                </div>
                                <div class="team-details">
                                    <div class="team-name">{{ exterieur.equipe.nomEquipe }}</div>
                                    <div class="team-code">{{ exterieur.equipe.codePays }}</div>
                                </div>
                            </div>
                        </div>

                        <div class="match-stats">
                            <div class="stat-item">
                                <span class="stat-icon">üèüÔ∏è</span>
                                <span>{{ match.stade.nom }}, {{ match.stade.ville }}</span>
                            </div>
                            {% if match.stade.capacite %}
                                <div class="stat-item">
                                    <span class="stat-icon">üë•</span>
                                    <span>{{ match.stade.capacite|number_format(0, ',', ' ') }} places</span>
                                </div>
                            {% endif %}
                            {% if domicile.prolongation or exterieur.prolongation %}
                                <div class="stat-item">
                                    <span class="stat-icon">‚è±Ô∏è</span>
                                    <span>Prolongation</span>
                                </div>
                            {% endif %}
                            {% if domicile.tirAuBut is not null %}
                                <div class="stat-item">
                                    <span class="stat-icon">üéØ</span>
                                    <span>TAB: {{ domicile.tirAuBut }}-{{ exterieur.tirAuBut }}</span>
                                </div>
                            {% endif %}
                        </div>
                    </a>
                {% else %}
                    <div style="text-align: center; padding: 64px 0; color: #8899a6;">
                        <div style="font-size: 64px; margin-bottom: 16px;">‚öΩ</div>
                        <p style="font-size: 18px;">Aucun match programm√© pour le moment</p>
                    </div>
                {% endfor %}
            </div>
        </main>

        <aside class="sidebar">
            <h2 class="sidebar-title">PROCHAINS MATCHS</h2>

            {% set upcomingCount = 0 %}
            {% for data in matchesData %}
                {% if data.match.statut == 'A_VENIR' and upcomingCount < 5 %}
                    {% set upcomingCount = upcomingCount + 1 %}
                    <div class="upcoming-match">
                        <div class="upcoming-match-time">
                            {{ data.match.dateHeure|date('d/m') }} ‚Ä¢ {{ data.match.dateHeure|date('H:i') }} ‚Ä¢ {{ data.match.phase.libelle }}
                        </div>
                        <div class="upcoming-teams">
                            <div class="upcoming-team">
                                <span class="upcoming-flag">
                                    {% if data.domicileDrapeau %}
                                        {{ data.domicileDrapeau }}
                                    {% else %}
                                        üè¥
                                    {% endif %}
                                </span>
                                <span>{{ data.domicile.equipe.nomEquipe }}</span>
                            </div>
                            <span style="color: #8899a6; font-weight: 700;">VS</span>
                            <div class="upcoming-team">
                                <span>{{ data.exterieur.equipe.nomEquipe }}</span>
                                <span class="upcoming-flag">
                                    {% if data.exterieurDrapeau %}
                                        {{ data.exterieurDrapeau }}
                                    {% else %}
                                        üè¥
                                    {% endif %}
                                </span>
                            </div>
                        </div>
                    </div>
                {% endif %}
            {% endfor %}

            <h2 class="sidebar-title" style="margin-top: 32px;">STATISTIQUES</h2>
            <div class="upcoming-match" style="cursor: default;">
                <div style="text-align: center; color: #8899a6; padding: 20px;">
                    <div style="font-size: 32px; margin-bottom: 8px;">üìä</div>
                    <p style="font-size: 14px;">Classements disponibles<br>apr√®s le d√©but de la comp√©tition</p>
                </div>
            </div>
        </aside>
    </div>
</div>
{% block javascripts %}
    <script>
        // Si le match est en direct
        document.addEventListener('DOMContentLoaded', function() {
            const liveBadge = document.querySelector('.status-live');
            
            if (liveBadge) {
                console.log("Match en direct : rafra√Æchissement...");
                setTimeout(function(){
                    window.location.reload();
                }, 7000); // 7000ms = 7 secondes
            }
        });
    </script>
{% endblock %}
{% endblock %}
